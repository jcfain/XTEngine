const systemInfoTab=document.getElementById("systemInfoTab");Settings={loaded:!1,SettingProfile:{System:0},FormControlTypes:{Double:0,Int:1,Text:2,Radio:3,Combo:4,Checkbox:5,DateTime:6,Date:7,Time:8},debounceer:{},debounceerTimeout:1e3,createForm(e){let t=document.createElement("div");t.id=e,t.classList.add("form");let i=document.createElement("h3");return i.innerText=capitalizeFirstLetter(e),t.appendChild(i),t},createFormControl(e,t,i,n){let o=document.createElement("div");o.classList.add("formElement");let r,a=document.createElement("label");switch(a.textContent=e,a.setAttribute("for",i),t){case this.FormControlTypes.Double:r=this.createDoubleInput(i,n);break;case this.FormControlTypes.Int:r=this.createNumberInput(i,n);break;case this.FormControlTypes.Text:r=this.createTextInput(i,n);break;case this.FormControlTypes.Radio:r=this.createRadioInput(i,n);break;case this.FormControlTypes.Combo:r=this.createComboInput(i,n);break;case this.FormControlTypes.Checkbox:r=this.createCheckboxInput(i,n);break;case this.FormControlTypes.Time:r=this.createTimeInput(i,n);break}return o.appendChild(a),r?o.appendChild(r):o.innerText=" Invalid control type:"+t,{div:o,label:a,control:r}},createInput(e){let t=document.createElement("input");return t.id=e,t},createTextInput(e,t){let i=this.createInput(e);return i.type="text",i.value=t,i.onchange=function(e,t){e.validity.valid&&(this.debounceer[t]&&clearTimeout(this.debounceer[t]),this.debounceer[t]=setTimeout(function(e,t){this.debounceer[e]=void 0,t.validity.valid&&settingChange(e,t.value)}.bind(this,t,e),this.debounceerTimeout))}.bind(this,i,e),i},createNumberInput(e,t){const i=this.createInput(e);return i.value=parseInt(t),i.type="number",i.onchange=function(e,t){(e.validity.valid||e.validity.stepMismatch)&&(this.debounceer[t]&&clearTimeout(this.debounceer[t]),this.debounceer[t]=setTimeout(function(e,t){this.debounceer[e]=void 0,(t.validity.valid||t.validity.stepMismatch)&&settingChange(e,parseInt(t.value))}.bind(this,t,e),this.debounceerTimeout))}.bind(this,i,e),i},createDoubleInput(e,t){const i=this.createInput(e);return i.value=parseFloat(t),i.type="number",i.onchange=function(e,t){(e.validity.valid||e.validity.stepMismatch)&&(this.debounceer[t]&&clearTimeout(this.debounceer[t]),this.debounceer[t]=setTimeout(function(e,t){this.debounceer[e]=void 0,(t.validity.valid||t.validity.stepMismatch)&&settingChange(e,parseFloat(t.value))}.bind(this,t,e),this.debounceerTimeout))}.bind(this,i,e),i},createTimeInput(e,t){const i=this.createTextInput(e,t);return i.type="time",i.value=new Date(t),i},createRadioInput(e,t,i){let n=this.createInput(e);return n.type="radio",n.name=t,n.checked=i,n.onchange=function(e,t){e.validity.valid&&(this.debounceer[t]&&clearTimeout(this.debounceer[t]),this.debounceer[t]=setTimeout(function(e,t){this.debounceer[e]=void 0,t.validity.valid&&settingChange(e,t.checked)}.bind(this,t,e),this.debounceerTimeout))}.bind(this,n,e),n},createCheckboxInput(e,t){let i=this.createInput(e);return i.type="checkbox",i.checked=t,i.onchange=function(e,t){e.validity.valid&&(this.debounceer[t]&&clearTimeout(this.debounceer[t]),this.debounceer[t]=setTimeout(function(e,t){this.debounceer[e]=void 0,t.validity.valid&&settingChange(e,t.checked)}.bind(this,t,e),this.debounceerTimeout))}.bind(this,i,e),i},createComboInput(e,t){let i=document.createElement("select");return i.id=e,t.forEach((e=>{let t=document.createElement("option");t.innerText=e.key,t.value=e.value,i.appendChild(t)})),i.onchange=function(e,t){this.debounceer[t]&&clearTimeout(debounceer[t]),this.debounceer[t]=setTimeout(function(e,t){this.debounceer[e]=void 0,t.validity.valid&&settingChange(e,t.value)}.bind(this,t,e),this.debounceerTimeout)}.bind(this,i,e),i},load(e){this.loaded||(e.settings.forEach((e=>{e.internal||this.loadSetting(e)})),this.loaded=!0)},loadSetting(e){if(this.loaded)return;let t=document.getElementById(e.group),i=!1;switch(t||(t=this.createForm(e.group),i=!0),e.profile){case this.SettingProfile.System:i&&systemInfoTab.appendChild(t);break;default:return void systemError("Invalid settings profile: "+e.profile)}const n=this.createFormControl(e.label,e.type,e.key,e.value);t.appendChild(n.div),this.setSpecialProperties(e.key,e.value,n)},setSpecialProperties(e,t,i){switch(e){case"playbackRateStep":document.getElementById("playbackRateInput").setAttribute("step",t),i.control.min=0,i.control.step=.01;break;case"httpChunkSizeMB":i.control.min=.5;break;case"scheduleLibraryLoadTime":i.control.min="00:00",i.control.max="23:59";break}}};