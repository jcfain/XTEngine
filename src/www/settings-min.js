const systemInfoTab=document.getElementById("systemInfoTab");Settings={loaded:!1,SettingProfile:{System:0},FormControlTypes:{Double:0,Int:1,Text:2,Radio:3,Combo:4,Checkbox:5,DateTime:6,Date:7,Time:8},debounceer:{},debounceerTimeout:1e3,createForm(e){let t=document.createElement("div");t.id=e,t.classList.add("form"),t.classList.add("tab-content-settings-section");let i=document.createElement("h3");return i.innerText=capitalizeFirstLetter(e),t.appendChild(i),t},createFormControl(e,t,i,n,a){let o=document.createElement("div");o.classList.add("formElement","formElement--label-large");let s,r=document.createElement("label");switch(r.setAttribute("title",e),r.textContent=e,r.setAttribute("for",i),t){case this.FormControlTypes.Double:s=this.createDoubleInput(i,n,a);break;case this.FormControlTypes.Int:s=this.createNumberInput(i,n,a);break;case this.FormControlTypes.Text:s=this.createTextInput(i,n,a);break;case this.FormControlTypes.Radio:s=this.createRadioInput(i,n,a);break;case this.FormControlTypes.Combo:s=this.createComboInput(i,n,a);break;case this.FormControlTypes.Checkbox:s=this.createCheckboxInput(i,n,a);break;case this.FormControlTypes.DateTime:s=this.createDateTimeInput(i,n,a);break;case this.FormControlTypes.Date:s=this.createDateInput(i,n,a);break;case this.FormControlTypes.Time:s=this.createTimeInput(i,n,a);break}return o.appendChild(r),s?o.appendChild(s):o.innerText=" Invalid control type:"+t,{div:o,label:r,control:s}},createInput(e){let t=document.createElement("input");return t.id=e,t},createTextInput(e,t,i){let n=this.createInput(e);return n.type="text",n.value=t,n.onchange=function(e,t){e.validity.valid&&(this.debounceer[t]&&clearTimeout(this.debounceer[t]),this.debounceer[t]=setTimeout(function(e,t){this.debounceer[e]=void 0,t.validity.valid&&(settingChange(e,t.value),this.callBackExtensions(e,t.value,t),i&&showRestartRequired())}.bind(this,t,e),this.debounceerTimeout))}.bind(this,n,e),n},createNumberInput(e,t,i){const n=this.createInput(e);return n.value=parseInt(t),n.type="number",n.onchange=function(e,t){(e.validity.valid||e.validity.stepMismatch)&&(this.debounceer[t]&&clearTimeout(this.debounceer[t]),this.debounceer[t]=setTimeout(function(e,t){this.debounceer[e]=void 0,(t.validity.valid||t.validity.stepMismatch)&&(settingChange(e,parseInt(t.value)),this.callBackExtensions(e,t.value,t),i&&showRestartRequired())}.bind(this,t,e),this.debounceerTimeout))}.bind(this,n,e),n},createDoubleInput(e,t,i){const n=this.createInput(e);return n.value=parseFloat(t),n.type="number",n.onchange=function(e,t){(e.validity.valid||e.validity.stepMismatch)&&(this.debounceer[t]&&clearTimeout(this.debounceer[t]),this.debounceer[t]=setTimeout(function(e,t){this.debounceer[e]=void 0,(t.validity.valid||t.validity.stepMismatch)&&(settingChange(e,parseFloat(t.value)),this.callBackExtensions(e,t.value,t),i&&showRestartRequired())}.bind(this,t,e),this.debounceerTimeout))}.bind(this,n,e),n},createTimeInput(e,t,i){const n=this.createTextInput(e,t);return n.type="time",n},createDateInput(e,t,i){const n=this.createTextInput(e,t);return n.type="date",n},createDateTimeInput(e,t,i){const n=this.createTextInput(e,t);return n.type="datetime-local",n},createRadioInput(e,t,i,n){let a=this.createInput(e);return a.type="radio",a.name=t,a.checked=i,a.onchange=function(e,t){e.validity.valid&&(this.debounceer[t]&&clearTimeout(this.debounceer[t]),this.debounceer[t]=setTimeout(function(e,t){this.debounceer[e]=void 0,t.validity.valid&&(settingChange(e,t.checked),this.callBackExtensions(e,t.checked,t),n&&showRestartRequired())}.bind(this,t,e),this.debounceerTimeout))}.bind(this,a,e),a},createCheckboxInput(e,t,i){let n=this.createInput(e);return n.type="checkbox",n.checked=t,n.onchange=function(e,t){e.validity.valid&&(this.debounceer[t]&&clearTimeout(this.debounceer[t]),this.debounceer[t]=setTimeout(function(e,t){this.debounceer[e]=void 0,t.validity.valid&&(settingChange(e,t.checked),this.callBackExtensions(e,t.checked,t),i&&showRestartRequired())}.bind(this,t,e),this.debounceerTimeout))}.bind(this,n,e),n},createComboInput(e,t,i){let n=document.createElement("select");return n.id=e,t.forEach((e=>{let t=document.createElement("option");t.innerText=e.key,t.value=e.value,n.appendChild(t)})),n.onchange=function(e,t){this.debounceer[t]&&clearTimeout(debounceer[t]),this.debounceer[t]=setTimeout(function(e,t){this.debounceer[e]=void 0,t.validity.valid&&(settingChange(e,t.value),this.callBackExtensions(e,t.value,t),i&&showRestartRequired())}.bind(this,t,e),this.debounceerTimeout)}.bind(this,n,e),n},load(e){this.loaded||(e.settings.forEach((e=>{e.internal||this.loadSetting(e)})),this.loaded=!0)},loadSetting(e){if(this.loaded)return;let t=document.getElementById(e.group),i=!1;switch(t||(t=this.createForm(e.group),i=!0),e.profile){case this.SettingProfile.System:i&&systemInfoTab.appendChild(t);break;default:return void systemError("Invalid settings profile: "+e.profile)}const n=this.createFormControl(e.label,e.type,e.key,e.value,e.requiresRestart);t.appendChild(n.div),this.setSpecialProperties(e.key,e.value,n)},setSpecialProperties(e,t,i){switch(e){case"playbackRateStep":document.getElementById("playbackRateInput").setAttribute("step",t),i.control.min=0,i.control.step=.01;break;case"httpChunkSizeMB":i.control.min=.5;break;case"scheduleLibraryLoadTime":i.control.min="00:00",i.control.max="23:59";break;case"enableMediaManagement":mediaManagementEnabled=t;break}},callBackExtensions(e,t,i){switch(e){case"enableMediaManagement":mediaManagementEnabled=t,showChange(showGlobal);break}}};